<!DOCTYPE html>
<html lang="en-US">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=1db909fa1f06ea7ae5dc1a7973fa98b17f58e65a" media="screen" type="text/css">
    <link rel="stylesheet" href="/assets/css/print.css" media="print" type="text/css">
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Trick | hahadsg’s note</title>
<meta name="generator" content="Jekyll v3.9.3">
<meta property="og:title" content="Trick">
<meta property="og:locale" content="en_US">
<link rel="canonical" href="https://hahadsg.github.io/python/pandas-note.html">
<meta property="og:url" content="https://hahadsg.github.io/python/pandas-note.html">
<meta property="og:site_name" content="hahadsg’s note">
<meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Trick">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","headline":"Trick","url":"https://hahadsg.github.io/python/pandas-note.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <header>
      <div class="inner">
        <a href="https://hahadsg.github.io/">
          <h1>hahadsg's note</h1>
        </a>
        <h2></h2>
        
        
          <a href="https://github.com/hahadsg" class="button"><small>Follow me on</small> GitHub</a>
        
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1 id="trick">Trick</h1>
<hr>

<h2 id="to-clipboard">to clipboard</h2>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pandas.io</span> <span class="kn">import</span> <span class="n">clipboard</span>
<span class="n">clipboard</span><span class="p">.</span><span class="n">clipboard_set</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="flatten-multiindex">flatten multiIndex</h2>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="s">'_'</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">pkg_pivot</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">values</span><span class="p">]</span>
</code></pre></div></div>

<h2 id="ix-deprecated">.ix deprecated</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="n">df</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s">'target'</span><span class="p">)]]</span>
</code></pre></div></div>

<h2 id="explode-list">explode list</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="n">target_column</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'，'</span><span class="p">))</span> \
    <span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">)</span> \
    <span class="p">.</span><span class="n">stack</span><span class="p">()</span> \
    <span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> \
    <span class="p">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">new_name</span><span class="p">)</span> \
    <span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="readwrite">read/write</h2>

<h3 id="write-to-excel-multi-sheet">write to excel multi-sheet</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'Data'</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">]})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'Data'</span><span class="p">:</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">]})</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'Data'</span><span class="p">:</span> <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">]})</span>

<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s">'./test.xlsx'</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s">'xlsxwriter'</span><span class="p">)</span>

<span class="n">df1</span><span class="p">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s">'Sheet1'</span><span class="p">)</span>
<span class="n">df2</span><span class="p">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s">'Sheet2'</span><span class="p">)</span>
<span class="n">df3</span><span class="p">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s">'Sheet3'</span><span class="p">)</span>

<span class="n">writer</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div></div>

<h1 id="problem">Problem</h1>
<hr>

<h2 id="关于copy">关于copy</h2>

<ul>
  <li>copy() 只会拷贝index和data，如果data是object不会进行深度拷贝</li>
</ul>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="k">class</span> <span class="nc">test</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
   <span class="p">...:</span>     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
   <span class="p">...:</span>         <span class="bp">self</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
   <span class="p">...:</span> 

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'A'</span><span class="p">:</span> <span class="p">[</span><span class="n">test</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">test</span><span class="p">(</span><span class="mi">3</span><span class="p">)]})</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> 
                                       <span class="n">A</span>
<span class="mi">0</span>  <span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">test</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x105aec908</span><span class="o">&gt;</span>
<span class="mi">1</span>  <span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">test</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x105aec940</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>copy()只会对index和data进行拷贝，如果data是object不会进行深度拷贝</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span> 

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">df2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> 
                                       <span class="n">A</span>
<span class="mi">0</span>  <span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">test</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x105aec908</span><span class="o">&gt;</span>
<span class="mi">1</span>  <span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">test</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x105aec940</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>用python自带的包进行deepcopy</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">copy</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">df3</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">df3</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span>
<span class="n">A</span>
<span class="mi">0</span> <span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">test</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x105b0e1d0</span><span class="o">&gt;</span>
<span class="mi">1</span> <span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">test</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x105b0e080</span><span class="o">&gt;</span>
</code></pre></div></div>

<h2 id="关于warning-a-value-is-trying-to-be-set-on-a-copy-of-a-slice-from-a-dataframe">关于Warning: A value is trying to be set on a copy of a slice from a DataFrame.</h2>

<ul>
  <li>这个问题很奇怪，如果df2是df的拷贝，那就不应该报警告；而df2是df的引用，那df2修改时df没有修改···</li>
</ul>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span>
   <span class="p">....:</span>         <span class="s">'A'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> 
   <span class="p">....:</span>         <span class="s">'B'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> 
   <span class="p">....:</span>         <span class="s">'C'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> 
   <span class="p">....:</span>     <span class="p">})</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">19</span><span class="p">]:</span> 
          <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">0</span>  <span class="mf">0.778093</span>  <span class="mf">0.534797</span> <span class="o">-</span><span class="mf">0.271507</span>
<span class="mi">1</span>  <span class="mf">1.536066</span>  <span class="mf">0.078380</span>  <span class="mf">0.028316</span>
<span class="mi">2</span> <span class="o">-</span><span class="mf">0.429115</span> <span class="o">-</span><span class="mf">2.397360</span> <span class="o">-</span><span class="mf">0.766024</span>
<span class="mi">3</span> <span class="o">-</span><span class="mf">0.154933</span> <span class="o">-</span><span class="mf">0.045179</span>  <span class="mf">0.350458</span>
<span class="mi">4</span> <span class="o">-</span><span class="mf">0.520098</span>  <span class="mf">1.142862</span>  <span class="mf">0.461002</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'A'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">:]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="n">df2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">21</span><span class="p">]:</span> 
          <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2</span> <span class="o">-</span><span class="mf">0.429115</span> <span class="o">-</span><span class="mf">2.397360</span> <span class="o">-</span><span class="mf">0.766024</span>
<span class="mi">3</span> <span class="o">-</span><span class="mf">0.154933</span> <span class="o">-</span><span class="mf">0.045179</span>  <span class="mf">0.350458</span>
<span class="mi">4</span> <span class="o">-</span><span class="mf">0.520098</span>  <span class="mf">1.142862</span>  <span class="mf">0.461002</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">df2</span><span class="p">[</span><span class="s">'B'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Frameworks</span><span class="o">/</span><span class="n">Python</span><span class="p">.</span><span class="n">framework</span><span class="o">/</span><span class="n">Versions</span><span class="o">/</span><span class="mf">3.5</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ipython</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span> <span class="n">SettingWithCopyWarning</span><span class="p">:</span> 
<span class="n">A</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">be</span> <span class="nb">set</span> <span class="n">on</span> <span class="n">a</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">slice</span> <span class="k">from</span> <span class="n">a</span> <span class="n">DataFrame</span><span class="p">.</span>
<span class="n">Try</span> <span class="n">using</span> <span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_indexer</span><span class="p">,</span><span class="n">col_indexer</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span> <span class="n">instead</span>

<span class="n">See</span> <span class="n">the</span> <span class="n">caveats</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">documentation</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">pandas</span><span class="p">.</span><span class="n">pydata</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">pandas</span><span class="o">-</span><span class="n">docs</span><span class="o">/</span><span class="n">stable</span><span class="o">/</span><span class="n">indexing</span><span class="p">.</span><span class="n">html</span><span class="c1">#indexing-view-versus-copy
</span>  <span class="c1">#!/Library/Frameworks/Python.framework/Versions/3.5/bin/python3.5
</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="n">df2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">23</span><span class="p">]:</span> 
          <span class="n">A</span>  <span class="n">B</span>         <span class="n">C</span>
<span class="mi">2</span> <span class="o">-</span><span class="mf">0.429115</span>  <span class="mi">1</span> <span class="o">-</span><span class="mf">0.766024</span>
<span class="mi">3</span> <span class="o">-</span><span class="mf">0.154933</span>  <span class="mi">1</span>  <span class="mf">0.350458</span>
<span class="mi">4</span> <span class="o">-</span><span class="mf">0.520098</span>  <span class="mi">1</span>  <span class="mf">0.461002</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">24</span><span class="p">]:</span> <span class="n">df</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">24</span><span class="p">]:</span> 
          <span class="n">A</span>         <span class="n">B</span>         <span class="n">C</span>
<span class="mi">0</span>  <span class="mf">0.778093</span>  <span class="mf">0.534797</span> <span class="o">-</span><span class="mf">0.271507</span>
<span class="mi">1</span>  <span class="mf">1.536066</span>  <span class="mf">0.078380</span>  <span class="mf">0.028316</span>
<span class="mi">2</span> <span class="o">-</span><span class="mf">0.429115</span> <span class="o">-</span><span class="mf">2.397360</span> <span class="o">-</span><span class="mf">0.766024</span>
<span class="mi">3</span> <span class="o">-</span><span class="mf">0.154933</span> <span class="o">-</span><span class="mf">0.045179</span>  <span class="mf">0.350458</span>
<span class="mi">4</span> <span class="o">-</span><span class="mf">0.520098</span>  <span class="mf">1.142862</span>  <span class="mf">0.461002</span>
</code></pre></div></div>

<h2 id="关于groupbyapply">关于groupby.apply</h2>

<ul>
  <li>很奇怪 groupby后apply会对每一行都进行计算</li>
</ul>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'a'</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s">'b'</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]})</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
   <span class="p">...:</span>     <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
   <span class="p">...:</span>     <span class="k">return</span> <span class="n">x</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
   <span class="p">...:</span> 

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'a'</span><span class="p">).</span><span class="nb">apply</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
   <span class="n">a</span>  <span class="n">b</span>
<span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>
<span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">3</span>
   <span class="n">a</span>  <span class="n">b</span>
<span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>
<span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">3</span>
   <span class="n">a</span>  <span class="n">b</span>
<span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> 
   <span class="n">a</span>  <span class="n">b</span>
<span class="n">a</span>      
<span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">5</span>
<span class="mi">3</span>  <span class="mi">3</span>  <span class="mi">4</span>
</code></pre></div></div>

<h2 id="关于pivot_table">关于pivot_table</h2>

<ul>
  <li>如果value中又空值，而aggfunc又不能处理空值，则会出错</li>
</ul>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span>
   <span class="p">...:</span>     <span class="s">'a'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
   <span class="p">...:</span>     <span class="s">'b'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
   <span class="p">...:</span>     <span class="s">'c'</span><span class="p">:</span> <span class="p">[</span><span class="s">'1'</span><span class="p">,</span> <span class="s">'1'</span><span class="p">,</span> <span class="s">'1'</span><span class="p">,</span> <span class="s">'1'</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span>
   <span class="p">...:</span> <span class="p">})</span>
   <span class="p">...:</span> 
<span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">a</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s">'c'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="s">'+'</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="c1"># 出错了
</span><span class="n">Out</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> 
<span class="n">b</span>      <span class="mi">1</span>      <span class="mi">2</span>
<span class="n">a</span>              
<span class="mi">1</span>  <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span>  <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span>
<span class="mi">2</span>  <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span>  <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">a</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s">'c'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="s">'+'</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="s">''</span><span class="p">)))</span> <span class="c1"># 没问题
</span><span class="n">Out</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> 
<span class="n">b</span>  <span class="mi">1</span>   <span class="mi">2</span>
<span class="n">a</span>       
<span class="mi">1</span>  <span class="mi">1</span>   <span class="mi">1</span>
<span class="mi">2</span>  <span class="mi">1</span>  <span class="mi">1</span><span class="o">+</span>
</code></pre></div></div>


        </section>

        <aside id="sidebar">
          

          

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</p>

          <p>由于笔记大部分来自于我之前的gitbook，可能会因为markdown规范不同导致公式显示错误，如果有显示错误请<a href="https://github.com/hahadsg/hahadsg.github.io/issues">找我</a>，感谢</p>
        </aside>
      </div>
    </div>

    
  </body>
</html>
