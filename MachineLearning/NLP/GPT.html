<!DOCTYPE html>
<html lang="en-US">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=1db909fa1f06ea7ae5dc1a7973fa98b17f58e65a" media="screen" type="text/css">
    <link rel="stylesheet" href="/assets/css/print.css" media="print" type="text/css">
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>GPT | hahadsg’s note</title>
<meta name="generator" content="Jekyll v3.9.3">
<meta property="og:title" content="GPT">
<meta property="og:locale" content="en_US">
<link rel="canonical" href="https://hahadsg.github.io/MachineLearning/NLP/GPT.html">
<meta property="og:url" content="https://hahadsg.github.io/MachineLearning/NLP/GPT.html">
<meta property="og:site_name" content="hahadsg’s note">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-02-20T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="GPT">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-02-20T00:00:00+00:00","datePublished":"2020-02-20T00:00:00+00:00","headline":"GPT","mainEntityOfPage":{"@type":"WebPage","@id":"https://hahadsg.github.io/MachineLearning/NLP/GPT.html"},"url":"https://hahadsg.github.io/MachineLearning/NLP/GPT.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <header>
      <div class="inner">
        <a href="https://hahadsg.github.io/">
          <h1>hahadsg's note</h1>
        </a>
        <h2></h2>
        
        
          <a href="https://github.com/hahadsg" class="button"><small>Follow me on</small> GitHub</a>
        
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1 id="gpt-generative-pre-training">GPT (Generative Pre-Training)</h1>

<p>论文提到现有NLP主要的痛点是不同任务之间没有进行整合，不能用一个结构解决所有问题。所以论文提出了GPT，它先是使用无标注数据进行预训练，再使用下游数据进行fine-tuning，另外提出了下游任务使用GPT的方法，将很多任务统一。</p>

<h2 id="结构">结构</h2>

<h3 id="无监督预训练阶段">无监督预训练阶段</h3>

<p>该阶段使用未标注的预料，使用了语言模型的方式进行预训练，也就是使用上文的词预测下一个词，最大似然的公式为：</p>

\[L_1(U) = \sum\limits_i \log P(u_i \mid u_{i-k}, ..., u_{i-1}; \Theta)\]

<p>其中\(U = \{u_1, ..., u_n\}\)代表预料中的句子，\(\Theta\)是模型的参数，可以看到这里用了一个窗口，只使用近\(k\)个词预测下一个词。</p>

<p>另外，GPT使用的是Transformer Decoder作为特征提取器，这里说的Decoder是指每次都预测一下次词的这个特性（也就是softmax），所以GPT可以用于生成式任务，但也就意味着GPT只是单向的，它只会向前面看，不会看后面的词。</p>

<h3 id="有监督的微调阶段">有监督的微调阶段</h3>

<p>对于下游的分类任务，假设我们的有标注数据为C，每个数据有\(x^1, ..., x^m\)这样\(m\)个特征以及标签\(y\)。把特征灌入预训练好的模型中，然后用最后一个词生成的隐向量进行softmax去预测标签，公式化这个过程：</p>

\[P(y\mid x^1, ..., x^m) = softmax(h_l^m W_y)\]

<p>这里的\(h_l^m\)是最后一个词生成的隐向量，\(W_y\)是softmax的参数。然后，最大似然函数为：</p>

\[L_2(C) = \sum\limits_{(x,y)} \log P(y \mid x^1, ..., x^m)\]

<p>另外，论文提到，如果将预训练的目标函数添加进来效果会更好，收敛也会更快，公式为：</p>

\[L_3(C) = L_2(C) + \lambda \times L_1(C)\]

<h3 id="下游任务">下游任务</h3>

<p>对于不同类型的下游任务，GPT提供了下面的方式进行建模（再配合上前面提到的目标函数），图示如下：</p>

<p><img src="./assets/GPT/downstream_task.jpg" alt="drawing" width="700"></p>

<p>从图中可以看到，对于不同任务我们可以：</p>

<ol>
  <li>分类任务：直接接一个softmax就好了</li>
  <li>文本蕴含（entailment）：将两个句子用分隔符隔开后接一个softmax</li>
  <li>相似度：将两个句子A和B，先提取A+B的特征，同时提取B+A的特征，两个合起来做一个损失</li>
  <li>问答（答案是多个候选集）：对每一个答案都做特征提取然后接一个多分类</li>
</ol>

<p>看到这里我在想，既然GPT是生成式的，那么问答型的任务能否直接生成呢？GPT是否也可以用于翻译任务呢？</p>

<h1 id="参考">参考</h1>

<p><a href="https://s3-us-west-2.amazonaws.com/openai-assets/research-covers/language-unsupervised/language_understanding_paper.pdf">Improving Language Understanding by Generative Pre-Training</a></p>

        </section>

        <aside id="sidebar">
          

          

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</p>

          <p>由于笔记大部分来自于我之前的gitbook，可能会因为markdown规范不同导致公式显示错误，如果有显示错误请<a href="https://github.com/hahadsg/hahadsg.github.io/issues">找我</a>，感谢</p>
        </aside>
      </div>
    </div>

    
  </body>
</html>
