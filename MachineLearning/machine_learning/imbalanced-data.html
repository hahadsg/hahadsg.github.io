<!DOCTYPE html>
<html lang="en-US">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=1db909fa1f06ea7ae5dc1a7973fa98b17f58e65a" media="screen" type="text/css">
    <link rel="stylesheet" href="/assets/css/print.css" media="print" type="text/css">
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>0.其他 | hahadsg’s note</title>
<meta name="generator" content="Jekyll v3.9.3">
<meta property="og:title" content="0.其他">
<meta property="og:locale" content="en_US">
<link rel="canonical" href="https://hahadsg.github.io/MachineLearning/machine_learning/imbalanced-data.html">
<meta property="og:url" content="https://hahadsg.github.io/MachineLearning/machine_learning/imbalanced-data.html">
<meta property="og:site_name" content="hahadsg’s note">
<meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="0.其他">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","headline":"0.其他","url":"https://hahadsg.github.io/MachineLearning/machine_learning/imbalanced-data.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <header>
      <div class="inner">
        <a href="https://hahadsg.github.io/">
          <h1>hahadsg's note</h1>
        </a>
        <h2></h2>
        
        
          <a href="https://github.com/hahadsg" class="button"><small>Follow me on</small> GitHub</a>
        
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h2 id="0其他">0.其他</h2>

<ul>
  <li>参考资料</li>
</ul>

<p><a href="http://www.zhaokv.com/2016/01/learning-from-imbalanced-data.html">http://www.zhaokv.com/2016/01/learning-from-imbalanced-data.html</a></p>

<p><a href="https://github.com/scikit-learn-contrib/imbalanced-learn">https://github.com/scikit-learn-contrib/imbalanced-learn</a></p>

<p><a href="https://florianhartl.com/thoughts-on-machine-learning-dealing-with-skewed-classes.html">https://florianhartl.com/thoughts-on-machine-learning-dealing-with-skewed-classes.html</a></p>

<ul>
  <li>python包</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># imbalanced-learn # import imblearn
sudo pip install -U imbalanced-learn
</code></pre></div></div>

<h2 id="1采样sampling">1.采样(Sampling)</h2>

<h3 id="11under-sampling">1.1.Under-sampling</h3>

<p>将数据多的类进行欠采样，即去掉一部分数据，使各类数据平衡</p>

<h3 id="12over-sampling">1.2.Over-sampling</h3>

<p>将数据多的类进行欠采样，即合成或者拷贝一些数据，使各类数据平衡。数据合成方法是利用已有样本生成更多样本，这类方法在小数据场景下有很多成功案例，比如医学图像分析等。</p>

<h4 id="121random-minority-over-sampling-with-replacement">1.2.1.Random minority over-sampling with replacement</h4>

<p>在已有的点中随机的进行拷贝</p>

<h4 id="122smote">1.2.2.SMOTE</h4>

<p>其中最常见的一种方法叫做SMOTE，它利用小众样本在特征空间的相似性来生成新样本。对于小众样本 \(x_i\in S_{\min}\) ，从它属于小众类的K近邻中随机选取一个样本点\(\hat{x}_i\) ，生成一个新的小众样本 \(x_{new}=x_i+(\hat{x}-x_i)\times\delta\)，其中 \(\delta\in[0,1]\) 是随机数。</p>

<p><img src="/MachineLearning/machine_learning/assets/imbalanced_data/smote.png" alt=""></p>

<p>上图是SMOTE方法在 (K=6) 近邻下的示意图，黑色方格是生成的新样本。</p>

<p>SMOTE为每个小众样本合成相同数量的新样本，这带来一些潜在的问题：一方面是增加了类之间重叠的可能性，另一方面是生成一些没有提供有益信息的样本。为了解决这个问题，出现两种方法：Borderline-SMOTE与ADASYN。</p>

<h4 id="123borderline-smote1--2">1.2.3.Borderline-SMOTE(1 &amp; 2)</h4>

<h4 id="124svm-smote">1.2.4.SVM SMOTE</h4>

<h4 id="125adasyn">1.2.5.ADASYN</h4>

<p>ADASYN的解决思路是根据数据分布情况为不同小众样本生成不同数量的新样本，为更难学习的样本点生成更多的点。首先根据最终的平衡程度设定总共需要生成的新小众样本数量\(G\) ，然后为每个小众样本\(x_i\)计算分布比例\(r_i=\frac{\Delta_i/K}{Z}\) ，其中\(\Delta_i\)是\(x_i\)K近邻中大众样本的数量，\(Z\)用来归一化使得\(\sum r_i=1\)，最后为小众样本\(x_i\)生成新样本的个数为\(g_i=r_i\times G\)，确定个数后再利用SMOTE生成新样本。</p>

<h3 id="13over-sampling-followed-by-under-sampling">1.3.Over-sampling followed by under-sampling</h3>

<p>上采样和下采样同时进行</p>

<h3 id="14ensemble-sampling">1.4.Ensemble-sampling</h3>

<p>对样本进行(多次)下采样，用集成的方式进行学习</p>

<h2 id="2评判标准metrics">2.评判标准(Metrics)</h2>

<p>考虑选取precision、recall、f1、roc_auc、cohen’s kappa等。<br>
一般要在precision和recall之间进行权衡，一个变高另一个一般就会变低。</p>

<h2 id="3原始数据分层采样stratified-sampling">3.原始数据分层采样(Stratified Sampling)</h2>

<p>将数据分成train、validation、test集的时候，进行分层抽样。数据原本就不太平衡了，在分割数据集的时候很容易造成数据更加不平衡。</p>

<h2 id="4阈值移动threshold-moving">4.阈值移动(Threshold Moving)</h2>

<p>我们通常将\(y &gt; 0.5\)判别为正例，\(y\)实际上表达了正例的可能性，几率\(\frac{y}{1-y}\)则反映了正例的可能性与反例可能性之比值，阈值设置为0.5恰好表明分类器认为真实正、反例可能性相同，我们可以调整\(y &gt; threshold\)来控制正、反例的可能性。</p>

<h2 id="5各类别权重class-weight">5.各类别权重(Class Weight)</h2>

<p>大多数分类器都有class_weight这个参数，代表了各类别的重要程度，对class_weight调参，获得更合理的权重系数。</p>

<h2 id="6一分类one-class-learning">6.一分类(One Class Learning)</h2>

<p>把问题看做一分类(One Class Learning)或者异常检测(Novelty Detection)问题，对其中一种分类建模，模型会划出一片封闭的区域，在区域中的点视为同一类，不在区域内的点视为不同区域的点。</p>

<h2 id="99个人感想">99.个人感想</h2>

<ul>
  <li>
    <p>不平衡数据中ROC_Curve的用处并没有想象中大，而PR_Curve更加有用</p>

    <p>参考：<a href="https://classeval.wordpress.com/reanalysis-of-a-previous-study/">https://classeval.wordpress.com/reanalysis-of-a-previous-study/</a></p>
  </li>
</ul>


        </section>

        <aside id="sidebar">
          

          

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</p>

          <p>由于笔记大部分来自于我之前的gitbook，可能会因为markdown规范不同导致公式显示错误，如果有显示错误请<a href="https://github.com/hahadsg/hahadsg.github.io/issues">找我</a>，感谢</p>
        </aside>
      </div>
    </div>

    
  </body>
</html>
